# Reporting Skill

## HOW: 리포트 생성 수행 방법

이 스킬은 데이터를 집계하고 마크다운 리포트를 생성하는 구체적인 방법을 정의합니다.

---

## 집계 프로세스

### 1단계: 코드 변환 결과 수집

변환된 표준 코드와 수량을 매핑합니다.

**방법**:
```
입력:
- 변환 결과: [{"external_code": "EXT-PROD-001", "standard_code": "STD-001-A"}, ...]
- 수량: [10, 5]

처리:
- zip(변환결과, 수량)으로 페어링
- 각 표준 코드별로 수량 합산
```

### 2단계: 표준 코드별 집계

동일한 표준 코드의 수량을 합산합니다.

**방법**:
```python
aggregated = defaultdict(int)
for conv, qty in zip(conversions, quantities):
    std_code = conv["standard_code"]
    aggregated[std_code] += qty
```

### 3단계: 정렬 및 포맷팅

집계 결과를 정렬하고 표 형식으로 변환합니다.

**방법**:
```
정렬: 표준 코드 알파벳 순
형식: 마크다운 테이블
```

---

## 리포트 형식

### 기본 마크다운 구조

```markdown
# 📊 표준 코드 집계 리포트

## 집계 결과

| 표준 코드 | 총 수량 |
|-----------|---------|
| STD-001-A | 10 |
| STD-100-V | 5 |

**총 항목 수**: 2개
**총 수량**: 15

## 변환 내역

| 외부 코드 | 표준 코드 | 카테고리 |
|-----------|-----------|----------|
| EXT-PROD-001 | STD-001-A | A |
| VENDOR-100 | STD-100-V | V |
```

---

## 커스터마이징 방법

### 표 형식 변경

**상황**: 사용자가 다른 표 형식 요청

**방법**:
1. `/memories/user_preferences.md`에서 선호 형식 확인
2. 해당 형식에 맞게 테이블 생성
3. 예: CSV 형식, HTML 테이블 등

### 추가 정보 포함

**상황**: 사용자가 추가 통계 요청

**방법**:
1. 집계 데이터에서 추가 통계 계산
2. 리포트에 새 섹션 추가
3. 예: 평균, 최대/최소, 카테고리별 합계 등

---

## 비교 분석 방법

### 과거 데이터와 비교

**방법**:
```
1. /memories/history/에서 과거 리포트 조회
2. 동일 표준 코드의 수량 비교
3. 증감 계산: (현재 - 과거) / 과거 * 100
4. 증감률을 포함한 테이블 생성
```

### 비교 리포트 형식

```markdown
## 증감 분석

| 표준 코드 | 이전 | 현재 | 증감 | 증감률 |
|-----------|------|------|------|--------|
| STD-001-A | 8 | 10 | +2 | +25% |
| STD-100-V | 5 | 5 | 0 | 0% |
```

---

## 템플릿 사용 방법

### 템플릿 구조

템플릿은 플레이스홀더를 포함한 마크다운 파일입니다:

```markdown
# {{TITLE}}

생성일: {{DATE}}

{{AGGREGATION_TABLE}}

{{CONVERSION_TABLE}}
```

### 템플릿 적용

**방법**:
1. 템플릿 파일 읽기
2. 플레이스홀더 식별
3. 실제 데이터로 치환
4. 최종 리포트 생성

---

## 검증 규칙

리포트 생성 후 다음을 검증합니다:

1. **데이터 정합성**: 입력 수량 합 = 출력 수량 합
2. **형식 준수**: 마크다운 문법 오류 없음
3. **완전성**: 모든 입력 코드가 리포트에 포함됨
